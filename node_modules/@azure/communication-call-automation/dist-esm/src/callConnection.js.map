{"version":3,"file":"callConnection.js","sourceRoot":"","sources":["../../src/callConnection.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport {\n  CommunicationIdentifier,\n  createCommunicationAuthPolicy,\n} from \"@azure/communication-common\";\nimport { CallMedia } from \"./callMedia\";\nimport {\n  AddParticipantRequest,\n  CallAutomationApiClient,\n  CallAutomationApiClientOptionalParams,\n  CustomCallingContextInternal,\n  MuteParticipantsRequest,\n  RemoveParticipantRequest,\n  TransferToParticipantRequest,\n} from \"./generated/src\";\nimport { CallConnectionImpl } from \"./generated/src/operations\";\nimport {\n  CallConnectionProperties,\n  CallInvite,\n  CallParticipant,\n  CustomCallingContext,\n} from \"./models/models\";\nimport {\n  AddParticipantOptions,\n  CancelAddParticipantOperationOptions,\n  GetCallConnectionPropertiesOptions,\n  GetParticipantOptions,\n  HangUpOptions,\n  MuteParticipantOption,\n  RemoveParticipantsOption,\n  TransferCallToParticipantOptions,\n} from \"./models/options\";\nimport {\n  ListParticipantsResult,\n  TransferCallResult,\n  AddParticipantResult,\n  RemoveParticipantResult,\n  MuteParticipantResult,\n  CancelAddParticipantOperationResult,\n} from \"./models/responses\";\nimport {\n  callParticipantConverter,\n  communicationIdentifierConverter,\n  communicationIdentifierModelConverter,\n  communicationUserIdentifierConverter,\n  phoneNumberIdentifierConverter,\n  PhoneNumberIdentifierModelConverter,\n} from \"./utli/converters\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { KeyCredential, TokenCredential } from \"@azure/core-auth\";\n\n/**\n * CallConnection class represents call connection based APIs.\n */\nexport class CallConnection {\n  private readonly callConnectionId: string;\n  private readonly callConnection: CallConnectionImpl;\n  private readonly callAutomationApiClient: CallAutomationApiClient;\n  private readonly endpoint: string;\n  private readonly credential: TokenCredential | KeyCredential;\n  private readonly callAutomationApiClientOptions?: CallAutomationApiClientOptionalParams;\n  constructor(\n    callConnectionId: string,\n    endpoint: string,\n    credential: KeyCredential | TokenCredential,\n    options?: CallAutomationApiClientOptionalParams,\n  ) {\n    this.callAutomationApiClient = new CallAutomationApiClient(endpoint, options);\n    const authPolicy = createCommunicationAuthPolicy(credential);\n    this.callAutomationApiClient.pipeline.addPolicy(authPolicy);\n    this.callConnectionId = callConnectionId;\n    this.callConnection = new CallConnectionImpl(this.callAutomationApiClient);\n    this.endpoint = endpoint;\n    this.credential = credential;\n    this.callAutomationApiClientOptions = options;\n  }\n\n  /**\n   * Initializes a new instance of CallMedia.\n   */\n  public getCallMedia(): CallMedia {\n    return new CallMedia(\n      this.callConnectionId,\n      this.endpoint,\n      this.credential,\n      this.callAutomationApiClientOptions,\n    );\n  }\n\n  /**\n   * Get call connection properties of the call\n   */\n  public async getCallConnectionProperties(\n    options: GetCallConnectionPropertiesOptions = {},\n  ): Promise<CallConnectionProperties> {\n    const { targets, sourceCallerIdNumber, answeredBy, source, ...result } =\n      await this.callConnection.getCall(this.callConnectionId, options);\n    const callConnectionProperties: CallConnectionProperties = {\n      ...result,\n      source: source ? communicationIdentifierConverter(source) : undefined,\n      answeredby: communicationUserIdentifierConverter(answeredBy),\n      targetParticipants: targets?.map((target) => communicationIdentifierConverter(target)),\n      sourceCallerIdNumber: sourceCallerIdNumber\n        ? phoneNumberIdentifierConverter(sourceCallerIdNumber)\n        : undefined,\n    };\n    return callConnectionProperties;\n  }\n\n  /**\n   * Hang up the call for itself or terminate the whole call.\n   *\n   * @param isForEveryOne - Determine if every one in the call would be hung up or not.\n   */\n  public async hangUp(isForEveryone: boolean, options: HangUpOptions = {}): Promise<void> {\n    if (isForEveryone) {\n      const optionsInternal = {\n        ...options,\n        repeatabilityFirstSent: new Date(),\n        repeatabilityRequestID: uuidv4(),\n      };\n      await this.callConnection.terminateCall(this.callConnectionId, optionsInternal);\n    } else {\n      await this.callConnection.hangupCall(this.callConnectionId, options);\n    }\n    return;\n  }\n\n  /**\n   * Get a participant from the call\n   *\n   * @param targetParticipant - The communication identifier of requested participant.\n   */\n  public async getParticipant(\n    targetParticipant: CommunicationIdentifier,\n    options: GetParticipantOptions = {},\n  ): Promise<CallParticipant> {\n    let rawId: string | undefined = communicationIdentifierModelConverter(targetParticipant).rawId;\n    rawId = rawId === undefined ? \"\" : rawId;\n\n    const result = await this.callConnection.getParticipant(this.callConnectionId, rawId, options);\n    const callParticipant: CallParticipant = {\n      identifier: result.identifier\n        ? communicationIdentifierConverter(result.identifier)\n        : undefined,\n      isMuted: result.isMuted,\n    };\n    return callParticipant;\n  }\n\n  /**\n   * Get all participants from the call\n   */\n  public async listParticipants(\n    options: GetParticipantOptions = {},\n  ): Promise<ListParticipantsResult> {\n    const result = this.callConnection.listParticipants(this.callConnectionId, options);\n    const participants = [];\n    const pages = result?.byPage();\n\n    for await (const page of pages) {\n      for (const participant of page) {\n        participants.push(callParticipantConverter(participant));\n      }\n    }\n\n    const listParticipantResponse: ListParticipantsResult = {\n      ...result,\n      values: participants,\n    };\n    return listParticipantResponse;\n  }\n\n  private createCustomCallingContextInternal(\n    customCallingContext: CustomCallingContext,\n  ): CustomCallingContextInternal {\n    const sipHeaders: { [key: string]: string } = {};\n    const voipHeaders: { [key: string]: string } = {};\n    if (customCallingContext) {\n      for (const header of customCallingContext) {\n        if (header.kind === \"sipuui\") {\n          sipHeaders[`User-To-User`] = header.value;\n        } else if (header.kind === \"sipx\") {\n          sipHeaders[`X-MS-Custom-${header.key}`] = header.value;\n        } else if (header.kind === \"voip\") {\n          voipHeaders[`${header.key}`] = header.value;\n        }\n      }\n    }\n    return { sipHeaders: sipHeaders, voipHeaders: voipHeaders };\n  }\n\n  /**\n   * Add a participant to the call\n   *\n   * @param participant - The participant is going to be added.\n   */\n  public async addParticipant(\n    targetParticipant: CallInvite,\n    options: AddParticipantOptions = {},\n  ): Promise<AddParticipantResult> {\n    const addParticipantRequest: AddParticipantRequest = {\n      participantToAdd: communicationIdentifierModelConverter(targetParticipant.targetParticipant),\n      sourceCallerIdNumber: PhoneNumberIdentifierModelConverter(\n        targetParticipant.sourceCallIdNumber,\n      ),\n      sourceDisplayName: targetParticipant.sourceDisplayName,\n      invitationTimeoutInSeconds: options.invitationTimeoutInSeconds,\n      operationContext: options.operationContext,\n      operationCallbackUri: options.operationCallbackUrl,\n      customCallingContext: this.createCustomCallingContextInternal(\n        targetParticipant.customCallingContext!,\n      ),\n    };\n    const optionsInternal = {\n      ...options,\n      repeatabilityFirstSent: new Date(),\n      repeatabilityRequestID: uuidv4(),\n    };\n    const result = await this.callConnection.addParticipant(\n      this.callConnectionId,\n      addParticipantRequest,\n      optionsInternal,\n    );\n    const addParticipantsResult: AddParticipantResult = {\n      ...result,\n      participant: {\n        ...result.participant,\n        identifier: result.participant?.identifier\n          ? communicationIdentifierConverter(result.participant?.identifier)\n          : undefined,\n      },\n    };\n    return addParticipantsResult;\n  }\n\n  /**\n   * Transfer the call to a target participant\n   *\n   * @param targetParticipant - The target to be transferred to.\n   */\n  public async transferCallToParticipant(\n    targetParticipant: CommunicationIdentifier,\n    options: TransferCallToParticipantOptions = {},\n  ): Promise<TransferCallResult> {\n    const transferToParticipantRequest: TransferToParticipantRequest = {\n      targetParticipant: communicationIdentifierModelConverter(targetParticipant),\n      operationContext: options.operationContext,\n      operationCallbackUri: options.operationCallbackUrl,\n      transferee: options.transferee && communicationIdentifierModelConverter(options.transferee),\n      customCallingContext: this.createCustomCallingContextInternal(options.customCallingContext!),\n    };\n    const optionsInternal = {\n      ...options,\n      repeatabilityFirstSent: new Date(),\n      repeatabilityRequestID: uuidv4(),\n    };\n    const result = await this.callConnection.transferToParticipant(\n      this.callConnectionId,\n      transferToParticipantRequest,\n      optionsInternal,\n    );\n    const transferCallResult: TransferCallResult = { ...result };\n    return transferCallResult;\n  }\n\n  /**\n   * Remove a participant from the call\n   *\n   * @param participant - The participant is going to be removed from the call.\n   */\n  public async removeParticipant(\n    participant: CommunicationIdentifier,\n    options: RemoveParticipantsOption = {},\n  ): Promise<RemoveParticipantResult> {\n    const removeParticipantRequest: RemoveParticipantRequest = {\n      participantToRemove: communicationIdentifierModelConverter(participant),\n      operationContext: options.operationContext,\n      operationCallbackUri: options.operationCallbackUrl,\n    };\n    const optionsInternal = {\n      ...options,\n      repeatabilityFirstSent: new Date(),\n      repeatabilityRequestID: uuidv4(),\n    };\n    const result = await this.callConnection.removeParticipant(\n      this.callConnectionId,\n      removeParticipantRequest,\n      optionsInternal,\n    );\n    const removeParticipantsResult: RemoveParticipantResult = {\n      ...result,\n    };\n    return removeParticipantsResult;\n  }\n\n  /**\n   * Mute participant from the call.\n   *\n   * @param participant - Participant to be muted from the call.\n   * @param options - Additional attributes for mute participant.\n   */\n  public async muteParticipant(\n    participant: CommunicationIdentifier,\n    options: MuteParticipantOption = {},\n  ): Promise<MuteParticipantResult> {\n    const muteParticipantsRequest: MuteParticipantsRequest = {\n      targetParticipants: [communicationIdentifierModelConverter(participant)],\n      operationContext: options.operationContext,\n    };\n    const optionsInternal = {\n      ...options,\n      repeatabilityFirstSent: new Date(),\n      repeatabilityRequestID: uuidv4(),\n    };\n    const result = await this.callConnection.mute(\n      this.callConnectionId,\n      muteParticipantsRequest,\n      optionsInternal,\n    );\n    const muteParticipantResult: MuteParticipantResult = {\n      ...result,\n    };\n    return muteParticipantResult;\n  }\n\n  /** Cancel add participant operation.\n   *\n   * @param invitationId - Invitation ID used to cancel the add participant request.\n   * @param options - Additional attributes for cancel add participant operation.\n   */\n  public async cancelAddParticipantOperation(\n    invitationId: string,\n    options: CancelAddParticipantOperationOptions = {},\n  ): Promise<CancelAddParticipantOperationResult> {\n    const {\n      operationContext,\n      operationCallbackUrl: operationCallbackUri,\n      ...operationOptions\n    } = options;\n    const cancelAddParticipantRequest = {\n      invitationId,\n      operationContext: options.operationContext,\n      operationCallbackUri,\n    };\n    const optionsInternal = {\n      ...operationOptions,\n      repeatabilityFirstSent: new Date(),\n      repeatabilityRequestID: uuidv4(),\n    };\n\n    return this.callConnection.cancelAddParticipant(\n      this.callConnectionId,\n      cancelAddParticipantRequest,\n      optionsInternal,\n    ) as Promise<CancelAddParticipantOperationResult>;\n  }\n}\n"]}